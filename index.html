<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ãƒãƒ‰ãƒŸãƒ³ãƒˆãƒ³è©¦åˆç®¡ç†</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background: #f0f4f8;
    }
    h1, h2 { text-align: center; }
    .controls {
      margin-bottom: 20px;
      padding: 15px;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    #matchType {
      font-size: 3em;
      padding: 10px 12px;
    }
    .controls label {
      display: block;
      margin: 10px 0 5px;
    }
    .controls input[type="range"] {
      display: block;
      width: 300px;        /* è¦ªè¦ç´ å¹…ã„ã£ã±ã„ã« */
      height: 20px;       /* ãƒãƒ¼ã®é«˜ã• */
      margin: 10px auto;  /* ä¸Šä¸‹ä½™ç™½ã€å·¦å³ä¸­å¤® */
    }
    .court-container {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      justify-content: center;
    }
    .controls button {
      font-size: 2em;   /* æ–‡å­—ã‚’å¤§ãã */
      padding: 10px 20px; /* ãƒœã‚¿ãƒ³ã®å¤§ãã•ã‚’åºƒã’ã‚‹ */
      margin: 5px;         /* ãƒœã‚¿ãƒ³é–“ã®ã‚¹ãƒšãƒ¼ã‚¹ */
      border-radius: 10px; /* è§’ä¸¸ */
    }
    .court {
      background: #fff;
      border-radius: 10px;
      padding: 15px;
      width: 200px;
      cursor: pointer;
      text-align: center;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      transition: transform 0.2s;
    }
    .court:hover { transform: scale(1.05); }
    .table-container {
      margin-top: 20px;
      background: #fff;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    table {
      width: 100%;
      border-collapse: collapse;
      text-align: center;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
    }
    th { background: #eee; }
    .message {
      margin-top: 10px;
      text-align: center;
      font-weight: bold;
      color: #0077cc;
    }
  </style>
</head>
<body>
  <h1>ğŸ¸ ãƒãƒ‰ãƒŸãƒ³ãƒˆãƒ³è©¦åˆç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </h1>

  <div class="controls">
    <label>äººæ•°: <span id="playerCountLabel">4</span></label>
    <input type="range" id="playerCount" min="2" max="20" value="4">
    
    <label>ã‚³ãƒ¼ãƒˆæ•°: <span id="courtCountLabel">2</span></label>
    <input type="range" id="courtCount" min="1" max="10" value="2">

    <label>è©¦åˆå½¢å¼:</label>
    <select id="matchType">
      <option value="singles">ã‚·ãƒ³ã‚°ãƒ«ã‚¹</option>
      <option value="doubles">ãƒ€ãƒ–ãƒ«ã‚¹</option>
    </select>

    <button id="generate">è©¦åˆç”Ÿæˆ</button>
    <button id="addPlayer">ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼è¿½åŠ </button>
    <button id="removePlayer">ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼å‰Šé™¤</button>
  </div>

  <h2>ã‚³ãƒ¼ãƒˆä¸€è¦§</h2>
  <div class="court-container" id="courts"></div>

  <div class="table-container">
    <h2>ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ç•ªå·è¡¨</h2>
    <table id="playerTable">
      <thead>
        <tr><th>ç•ªå·</th><th>çŠ¶æ…‹</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <div class="message" id="message"></div>

  <script>
    let players = [];
    let matches = [];
    let courts = [];
    let currentMatchIndex = [];

    const playerCountInput = document.getElementById("playerCount");
    const courtCountInput = document.getElementById("courtCount");
    const matchTypeInput = document.getElementById("matchType");
    const courtsDiv = document.getElementById("courts");
    const messageDiv = document.getElementById("message");
    const playerTableBody = document.querySelector("#playerTable tbody");

    function updateLabels() {
      document.getElementById("playerCountLabel").innerText = playerCountInput.value;
      document.getElementById("courtCountLabel").innerText = courtCountInput.value;
    }

    function updatePlayerTable() {
      playerTableBody.innerHTML = "";
      let maxNumber = Math.max(...players.map(p => p.id), playerCountInput.value);
      for (let i = 1; i <= maxNumber; i++) {
        let row = document.createElement("tr");
        let player = players.find(p => p.id === i);
        row.innerHTML = `<td>${i}</td><td>${player ? "å‚åŠ ä¸­" : "ç©ºå¸­"}</td>`;
        playerTableBody.appendChild(row);
      }
    }

    function generatePlayers() {
      let n = parseInt(playerCountInput.value);
      let existingIds = players.map(p => p.id);
      players = [];
      for (let i = 1; i <= n; i++) {
        players.push({id: i});
      }
      updatePlayerTable();
    }

    function generateMatches() {
      let type = matchTypeInput.value;
      let groupSize = (type === "singles") ? 2 : 4;
      let shuffled = [...players].sort(() => Math.random() - 0.5);
      matches = [];
      for (let i = 0; i < shuffled.length; i += groupSize) {
        if (i + groupSize <= shuffled.length) {
          matches.push(shuffled.slice(i, i + groupSize));
        }
      }
    }

    function generateCourts() {
      let c = parseInt(courtCountInput.value);
      courts = Array.from({length: c}, (_, i) => i);
      currentMatchIndex = new Array(c).fill(0);
      renderCourts();
    }

    function renderCourts() {
      courtsDiv.innerHTML = "";
      courts.forEach((court, index) => {
        let match = matches[currentMatchIndex[index]];
        let div = document.createElement("div");
        div.className = "court";
        div.onclick = () => nextMatch(index);
        div.innerHTML = `
          <h3>ã‚³ãƒ¼ãƒˆ ${index+1}</h3>
          <p>${match ? match.map(p => p.id).join(" vs ") : "è©¦åˆãªã—"}</p>
        `;
        courtsDiv.appendChild(div);
      });
    }

    function nextMatch(courtIndex) {
      if (currentMatchIndex[courtIndex] < matches.length - 1) {
        currentMatchIndex[courtIndex]++;
      } else {
        currentMatchIndex[courtIndex] = 0;
      }
      renderCourts();
    }

    function addPlayer() {
      // ç©ºå¸­ã‚’æ¢ã™
      let maxNumber = Math.max(...players.map(p => p.id), playerCountInput.value);
      let empty = [];
      for (let i = 1; i <= maxNumber; i++) {
        if (!players.find(p => p.id === i)) empty.push(i);
      }

      let newId;
      if (empty.length > 0) {
        newId = empty[0];
      } else {
        newId = maxNumber + 1;
        playerCountInput.value = newId;
      }
      players.push({id: newId});
      updatePlayerTable();
      messageDiv.innerText = `æ–°ã—ã ${newId} ç•ªã®ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸ`;
    }

    function removePlayer() {
      let id = parseInt(prompt("å‰Šé™¤ã™ã‚‹ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:"));
      if (isNaN(id)) return;
      let index = players.findIndex(p => p.id === id);
      if (index !== -1) {
        players.splice(index, 1);
        updatePlayerTable();
        messageDiv.innerText = `${id} ç•ªã®ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒå‰Šé™¤ã•ã‚Œã¾ã—ãŸ`;
      } else {
        messageDiv.innerText = `${id} ç•ªã®ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯å­˜åœ¨ã—ã¾ã›ã‚“`;
      }
    }

    document.getElementById("generate").onclick = () => {
      generatePlayers();
      generateMatches();
      generateCourts();
    };
    document.getElementById("addPlayer").onclick = addPlayer;
    document.getElementById("removePlayer").onclick = removePlayer;

    playerCountInput.oninput = () => { updateLabels(); generatePlayers(); };
    courtCountInput.oninput = () => { updateLabels(); generateCourts(); };

    updateLabels();
    generatePlayers();
    generateMatches();
    generateCourts();
  </script>
</body>
</html>
